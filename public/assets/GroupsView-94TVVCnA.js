import{a as B,g as c,h as C,i as D,c as r,b as e,k as y,e as v,t as i,F as G,l as M,s as F,q as E,v as P,x as q,z,N as h,u as L,o as n,n as T}from"./index-klw2IyYl.js";const R={id:"groups",class:"content-page p-6"},H={key:0,class:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4"},J={key:1,class:"text-center py-8"},K={key:2,class:"text-center py-12"},O={key:3,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},Q={class:"flex items-center justify-between mb-4"},W={class:"text-lg font-semibold text-gray-800 mb-2"},X={class:"text-gray-600 text-sm mb-4"},Y={class:"flex items-center justify-between text-sm text-gray-500 mb-4"},Z={class:"text-blue-600"},ee={class:"flex space-x-2"},te=["onClick"],se=["onClick"],le={key:4,class:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50"},ae={class:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white"},oe={class:"mt-3"},re={class:"flex justify-between items-center mb-4"},ne={class:"text-lg font-medium text-gray-900"},ue=["value"],ie={class:"flex justify-end space-x-3 pt-4"},de=["disabled"],ce={key:0,class:"fas fa-spinner fa-spin mr-2"},ge={__name:"GroupsView",setup(ve){const I=L(),m=B(),d=c(!1),u=c(""),o=c([]),x=c([]),f=c(!1),p=c(!1),_=c(null),a=c({id:null,name:"",level_id:""});C(()=>o.value.filter(s=>s.is_active!==!1)),C(()=>o.value.filter(s=>s.is_active===!1));const w=s=>{const t=x.value.find(l=>l.id===s);return t?t.name:"Unknown Course"},N=async()=>{try{const s=await z.getAll();x.value=s.data||s}catch(s){console.error("Error fetching courses:",s)}},S=async()=>{if(!m.userId){u.value="User not authenticated";return}d.value=!0;try{const s=await h.getByTeacherId(m.userId),t=s.data||s;o.value=Array.isArray(t)?t:[],u.value=""}catch(s){u.value=`Failed to fetch groups: ${s.message||"Unknown error"}`,console.error("Error fetching groups:",s),o.value=[]}finally{d.value=!1}},k=()=>{p.value=!1,a.value={id:null,name:"",level_id:""},f.value=!0},A=s=>{p.value=!0,_.value=s,a.value={id:s.id,name:s.name||"",level_id:s.level_id||""},f.value=!0},b=()=>{f.value=!1,_.value=null},U=async()=>{if(!a.value.name){u.value="Please enter a group name";return}if(!a.value.level_id){u.value="Please select a course";return}d.value=!0;try{const s={name:a.value.name,teacher_id:m.userId,level_id:a.value.level_id};if(p.value){const t=await h.update(a.value.id,s),l=t.data||t,g=o.value.findIndex($=>$.id===a.value.id);g!==-1&&(o.value[g]={...o.value[g],...l})}else{const t=await h.create(s),l=t.data||t;l&&l.id&&o.value.push(l)}b(),u.value=""}catch(s){u.value=`Failed to save group: ${s.message||"Unknown error"}`,console.error("Error saving group:",s)}finally{d.value=!1}},V=s=>{I.push(`/groups/${s.id}/manage`)},j=s=>s.students?.length||0;return D(()=>{N(),S()}),(s,t)=>(n(),r("div",R,[e("div",{class:"mb-6"},[e("div",{class:"flex justify-between items-center"},[t[3]||(t[3]=e("div",null,[e("h2",{class:"text-2xl font-bold text-gray-800"},"Group Management"),e("p",{class:"text-gray-600"},"Manage your teaching groups and students")],-1)),e("button",{onClick:k,class:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors"},t[2]||(t[2]=[e("i",{class:"fas fa-plus mr-2"},null,-1),v("Create Group ")]))])]),u.value?(n(),r("div",H,i(u.value),1)):y("",!0),d.value&&o.value.length===0?(n(),r("div",J,t[4]||(t[4]=[e("i",{class:"fas fa-spinner fa-spin text-gray-400 text-2xl mb-2"},null,-1),e("p",{class:"text-gray-500"},"Loading groups...",-1)]))):!d.value&&o.value.length===0?(n(),r("div",K,[t[6]||(t[6]=e("i",{class:"fas fa-users text-gray-400 text-4xl mb-4"},null,-1)),t[7]||(t[7]=e("h3",{class:"text-lg font-medium text-gray-900 mb-2"},"No groups yet",-1)),t[8]||(t[8]=e("p",{class:"text-gray-500 mb-4"},"Create your first group to start managing students",-1)),e("button",{onClick:k,class:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700"},t[5]||(t[5]=[e("i",{class:"fas fa-plus mr-2"},null,-1),v("Create Group ")]))])):(n(),r("div",O,[(n(!0),r(G,null,M(o.value,l=>(n(),r("div",{key:l.id,class:"bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow"},[e("div",Q,[t[9]||(t[9]=e("div",{class:"p-3 rounded-full bg-blue-100 text-blue-600"},[e("i",{class:"fas fa-users text-xl"})],-1)),e("span",{class:T([l.is_active!==!1?"bg-green-100 text-green-800":"bg-red-100 text-red-800","px-2 py-1 text-xs font-medium rounded-full"])},i(l.is_active!==!1?"Active":"Inactive"),3)]),e("h3",W,i(l.name),1),e("p",X,i(w(l.level_id)),1),e("div",Y,[e("span",null,[t[10]||(t[10]=e("i",{class:"fas fa-users mr-1"},null,-1)),v(i(j(l))+" Students",1)]),e("span",Z,i(w(l.level_id)),1)]),e("div",ee,[e("button",{onClick:g=>V(l),class:"flex-1 bg-blue-600 text-white py-1.5 px-3 text-sm rounded-lg hover:bg-blue-700 transition-colors"},t[11]||(t[11]=[e("i",{class:"fas fa-users mr-1"},null,-1),v("Manage ")]),8,te),e("button",{onClick:g=>A(l),class:"flex-1 bg-green-600 text-white py-1.5 px-3 text-sm rounded-lg hover:bg-green-700 transition-colors"},t[12]||(t[12]=[e("i",{class:"fas fa-edit mr-1"},null,-1),v("Edit ")]),8,se)])]))),128))])),f.value?(n(),r("div",le,[e("div",ae,[e("div",oe,[e("div",re,[e("h3",ne,i(p.value?"Edit Group":"Create New Group"),1),e("button",{onClick:b,class:"text-gray-400 hover:text-gray-600"},t[13]||(t[13]=[e("i",{class:"fas fa-times"},null,-1)]))]),e("form",{onSubmit:F(U,["prevent"]),class:"space-y-4"},[e("div",null,[t[14]||(t[14]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},[v(" Group Name "),e("span",{class:"text-red-500"},"*")],-1)),E(e("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=l=>a.value.name=l),required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter group name"},null,512),[[P,a.value.name]])]),e("div",null,[t[16]||(t[16]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},[v(" Course "),e("span",{class:"text-red-500"},"*")],-1)),E(e("select",{"onUpdate:modelValue":t[1]||(t[1]=l=>a.value.level_id=l),required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},[t[15]||(t[15]=e("option",{value:""},"Select Course",-1)),(n(!0),r(G,null,M(x.value,l=>(n(),r("option",{key:l.id,value:l.id},i(l.title),9,ue))),128))],512),[[q,a.value.level_id]])]),e("div",ie,[e("button",{type:"button",onClick:b,class:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50"}," Cancel "),e("button",{type:"submit",disabled:d.value,class:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50"},[d.value?(n(),r("i",ce)):y("",!0),v(" "+i(p.value?"Update":"Create"),1)],8,de)])],32)])])])):y("",!0)]))}};export{ge as default};
