import{a as q,g as d,K as J,h as L,i as T,c as n,b as e,k as g,e as p,t as u,n as h,F as E,l as N,s as R,q as w,v as k,N as U,O as _,P as B,u as z,o as r}from"./index-klw2IyYl.js";const K={class:"p-6"},O={class:"mb-6"},H={class:"flex items-center justify-between"},Q={class:"flex items-center gap-4"},W={class:"text-2xl font-bold text-gray-800"},X={key:0,class:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4"},Y={class:"mb-6"},Z={class:"border-b border-gray-200"},ee={class:"-mb-px flex space-x-8"},te={key:1},se={key:0,class:"text-center py-8"},ae={key:1,class:"text-center py-12"},ne={key:2,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},re={class:"flex items-center justify-between mb-3"},oe={class:"flex items-center gap-3"},le={class:"font-medium text-gray-800"},de={class:"text-sm text-gray-500"},ue=["onClick"],ie={key:0,class:"text-sm text-gray-600"},ce={key:2},pe={class:"bg-white rounded-lg border border-gray-200"},me={class:"overflow-x-auto"},ge={class:"min-w-full divide-y divide-gray-200"},xe={class:"bg-white divide-y divide-gray-200"},ve={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},ye={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},be={class:"px-6 py-4 whitespace-nowrap"},fe={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},he=["onClick"],we={key:0,class:"text-center py-8"},ke={key:3,class:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50"},_e={class:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white"},Se={class:"mt-3"},Ee={__name:"GroupManagementView",setup(Ae){const D=J(),F=z();q();const i=d(D.params.id),S=d(null),c=d([]),x=d([]),v=d(!1),o=d(""),m=d("students"),y=d(!1),l=d({name:"",email:"",phone:""}),M=L(()=>S.value?.name||"Group"),G=async()=>{if(i.value)try{const a=await U.getById(i.value);S.value=a.data||a}catch(a){console.error("Error fetching group:",a),o.value="Failed to load group details"}},I=async()=>{if(i.value){v.value=!0;try{const a=await _.getByGroupId(i.value);c.value=a.data||a||[],o.value=""}catch(a){console.error("Error fetching students:",a),o.value="Failed to load students",c.value=[]}finally{v.value=!1}}},A=async()=>{if(i.value)try{const a=await B.getByGroupId(i.value);x.value=a.data||a||[]}catch(a){console.error("Error fetching attendance:",a),o.value="Failed to load attendance data",x.value=[{id:1,date:"2025-07-20",student_name:"John Doe",status:"present",student_id:1},{id:2,date:"2025-07-20",student_name:"Jane Smith",status:"absent",student_id:2},{id:3,date:"2025-07-21",student_name:"John Doe",status:"absent",student_id:1},{id:4,date:"2025-07-21",student_name:"Jane Smith",status:"present",student_id:2}]}},P=()=>{F.push("/groups")},C=()=>{l.value={name:"",email:"",phone:""},y.value=!0},b=()=>{y.value=!1},V=async()=>{if(!l.value.name||!l.value.email){o.value="Please fill in required fields";return}try{const a={...l.value,group_id:i.value},t=await _.create(a),s=t.data||t;s&&c.value.push(s),b(),o.value=""}catch(a){console.error("Error adding student:",a),o.value="Failed to add student"}},j=async a=>{if(confirm(`Are you sure you want to remove ${a.name} from this group?`))try{await _.delete(a.id),c.value=c.value.filter(t=>t.id!==a.id),o.value=""}catch(t){console.error("Error removing student:",t),o.value="Failed to remove student"}},$=async(a,t,s)=>{try{await B.mark({student_id:a,date:t,status:s,group_id:i.value}),await A(),o.value=""}catch(f){console.error("Error marking attendance:",f),o.value="Failed to mark attendance"}};return T(()=>{G(),I(),A()}),(a,t)=>(r(),n("div",K,[e("div",O,[e("div",H,[e("div",Q,[e("button",{onClick:P,class:"bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700 transition-colors flex items-center gap-2"},t[5]||(t[5]=[e("i",{class:"fas fa-arrow-left"},null,-1),p(" Back to Groups ")])),e("div",null,[e("h2",W,u(M.value),1),t[6]||(t[6]=e("p",{class:"text-gray-600"},"Group Management",-1))])])])]),o.value?(r(),n("div",X,u(o.value),1)):g("",!0),e("div",Y,[e("div",Z,[e("nav",ee,[e("button",{onClick:t[0]||(t[0]=s=>m.value="students"),class:h([m.value==="students"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm"])},[t[7]||(t[7]=e("i",{class:"fas fa-users mr-2"},null,-1)),p(" Students ("+u(c.value.length)+") ",1)],2),e("button",{onClick:t[1]||(t[1]=s=>m.value="attendance"),class:h([m.value==="attendance"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm"])},t[8]||(t[8]=[e("i",{class:"fas fa-calendar-check mr-2"},null,-1),p(" Attendance ")]),2)])])]),m.value==="students"?(r(),n("div",te,[e("div",{class:"mb-4"},[e("button",{onClick:C,class:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors"},t[9]||(t[9]=[e("i",{class:"fas fa-plus mr-2"},null,-1),p("Add Student ")]))]),v.value?(r(),n("div",se,t[10]||(t[10]=[e("i",{class:"fas fa-spinner fa-spin text-gray-400 text-2xl mb-2"},null,-1),e("p",{class:"text-gray-500"},"Loading students...",-1)]))):c.value.length===0?(r(),n("div",ae,[t[12]||(t[12]=e("i",{class:"fas fa-user-plus text-gray-400 text-4xl mb-4"},null,-1)),t[13]||(t[13]=e("h3",{class:"text-lg font-medium text-gray-900 mb-2"},"No students yet",-1)),t[14]||(t[14]=e("p",{class:"text-gray-500 mb-4"},"Add your first student to this group",-1)),e("button",{onClick:C,class:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700"},t[11]||(t[11]=[e("i",{class:"fas fa-plus mr-2"},null,-1),p("Add Student ")]))])):(r(),n("div",ne,[(r(!0),n(E,null,N(c.value,s=>(r(),n("div",{key:s.id,class:"bg-white p-4 rounded-lg border border-gray-200 hover:shadow-md transition-shadow"},[e("div",re,[e("div",oe,[t[15]||(t[15]=e("div",{class:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center"},[e("i",{class:"fas fa-user text-blue-600"})],-1)),e("div",null,[e("h4",le,u(s.name),1),e("p",de,u(s.email),1)])]),e("button",{onClick:f=>j(s),class:"text-red-500 hover:text-red-700 text-sm"},t[16]||(t[16]=[e("i",{class:"fas fa-trash"},null,-1)]),8,ue)]),s.phone?(r(),n("div",ie,[t[17]||(t[17]=e("i",{class:"fas fa-phone mr-1"},null,-1)),p(u(s.phone),1)])):g("",!0)]))),128))]))])):g("",!0),m.value==="attendance"?(r(),n("div",ce,[e("div",pe,[t[20]||(t[20]=e("div",{class:"px-6 py-4 border-b border-gray-200"},[e("h3",{class:"text-lg font-medium text-gray-900"},"Attendance Records")],-1)),e("div",me,[e("table",ge,[t[18]||(t[18]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Date "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Student "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Status "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Actions ")])],-1)),e("tbody",xe,[(r(!0),n(E,null,N(x.value,s=>(r(),n("tr",{key:s.id},[e("td",ve,u(new Date(s.date).toLocaleDateString()),1),e("td",ye,u(s.student_name),1),e("td",be,[e("span",{class:h([s.status==="present"?"bg-green-100 text-green-800":"bg-red-100 text-red-800","px-2 py-1 text-xs font-medium rounded-full"])},u(s.status==="present"?"Present":"Absent"),3)]),e("td",fe,[e("button",{onClick:f=>$(s.student_id,s.date,s.status==="present"?"absent":"present"),class:"text-blue-600 hover:text-blue-800"}," Toggle ",8,he)])]))),128))])])]),x.value.length===0?(r(),n("div",we,t[19]||(t[19]=[e("i",{class:"fas fa-calendar-times text-gray-400 text-2xl mb-2"},null,-1),e("p",{class:"text-gray-500"},"No attendance records found",-1)]))):g("",!0)])])):g("",!0),y.value?(r(),n("div",ke,[e("div",_e,[e("div",Se,[e("div",{class:"flex justify-between items-center mb-4"},[t[22]||(t[22]=e("h3",{class:"text-lg font-medium text-gray-900"},"Add New Student",-1)),e("button",{onClick:b,class:"text-gray-400 hover:text-gray-600"},t[21]||(t[21]=[e("i",{class:"fas fa-times"},null,-1)]))]),e("form",{onSubmit:R(V,["prevent"]),class:"space-y-4"},[e("div",null,[t[23]||(t[23]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},[p(" Student Name "),e("span",{class:"text-red-500"},"*")],-1)),w(e("input",{type:"text","onUpdate:modelValue":t[2]||(t[2]=s=>l.value.name=s),required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter student name"},null,512),[[k,l.value.name]])]),e("div",null,[t[24]||(t[24]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},[p(" Email "),e("span",{class:"text-red-500"},"*")],-1)),w(e("input",{type:"email","onUpdate:modelValue":t[3]||(t[3]=s=>l.value.email=s),required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter email address"},null,512),[[k,l.value.email]])]),e("div",null,[t[25]||(t[25]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," Phone Number ",-1)),w(e("input",{type:"tel","onUpdate:modelValue":t[4]||(t[4]=s=>l.value.phone=s),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter phone number"},null,512),[[k,l.value.phone]])]),e("div",{class:"flex justify-end space-x-3 pt-4"},[e("button",{type:"button",onClick:b,class:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50"}," Cancel "),t[26]||(t[26]=e("button",{type:"submit",class:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700"}," Add Student ",-1))])],32)])])])):g("",!0)]))}};export{Ee as default};
